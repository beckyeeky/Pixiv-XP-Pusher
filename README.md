# Pixiv-XP-Pusher

> ğŸ¨ **æ™ºèƒ½ XP æ•è·ä¸æ¨é€ç³»ç»Ÿ**
> 
> åŸºäºç”¨æˆ·æ”¶è—è‡ªåŠ¨åˆ†æ XPï¼ˆæ€§ç™–/å…´è¶£åå¥½ï¼‰ç”»åƒï¼Œå…¨ç½‘æœç´¢å¹¶æ™ºèƒ½æ¨é€æœ€æ‡‚ä½ çš„ Pixiv æ’ç”»ã€‚æ”¯æŒ Telegram / QQ (OneBot) å¤šæ¸ é“æ¨é€ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ§  **XP ç”»åƒæ„å»º** - æ·±åº¦åˆ†æä½ çš„æ”¶è—å¤¹ï¼Œæå–æ ¸å¿ƒ Tag æƒé‡ï¼Œæ¯”ä½ æ›´æ‡‚ä½ çš„å£å‘³
- ğŸ¤– **AI æ™ºèƒ½æ¸…æ´—** - (å¯é€‰) é›†æˆ LLM (OpenAI/DeepSeek) è¿‡æ»¤æ— æ„ä¹‰æ ‡ç­¾ã€å½’å¹¶åŒä¹‰è¯ï¼Œæ„å»ºç²¾å‡†ç”»åƒ
- ğŸ” **æ··åˆæœç´¢ç­–ç•¥** - 
  - **XP æœç´¢**: åŸºäºç”»åƒæƒé‡çš„å¤šæ ‡ç­¾ç»„åˆæœç´¢
  - **ç”»å¸ˆè®¢é˜…**: è‡ªåŠ¨è¿½è¸ªå…³æ³¨ç”»å¸ˆçš„æœ€æ–°ä½œå“
  - **æ’è¡Œæ¦œ**: æ¯æ—¥/æ¯å‘¨æ’è¡Œæ¦œç­›é€‰
- ğŸ“‰ **æ™ºèƒ½è¿‡æ»¤** - 
  - å¤šç»´åº¦å»é‡ï¼ˆID/å›¾ç‰‡æŒ‡çº¹ï¼‰
  - AI ä½œç”»æ£€æµ‹ä¸è¿‡æ»¤
  - åŠ¨æ€é˜ˆå€¼ï¼ˆçƒ­é—¨ Tag éœ€é«˜æ”¶è—ï¼Œå†·é—¨ Tag å®½å®¹åº¦é«˜ï¼‰
- ğŸ“± **å¤šæ¸ é“æ¨é€** - 
  - **Telegram**: æ”¯æŒ MediaGroup å›¾é›†ã€ç›´ä¼ å›¾ç‰‡ï¼ˆé˜²é˜²ç›—é“¾/è¢«å¢™ï¼‰ã€äº’åŠ¨åé¦ˆæŒ‰é’®
  - **OneBot (QQ)**: æ”¯æŒ Go-CQHTTP/Lagrangeï¼Œé“¾æ¥å¡ç‰‡æˆ–å›¾æ–‡æ¶ˆæ¯
- âš™ï¸ **å®Œå…¨è‡ªåŠ¨åŒ–** - å†…ç½®è°ƒåº¦å™¨ï¼Œæ”¯æŒ Cron è¡¨è¾¾å¼å®šæ—¶è¿è¡Œ
- ğŸ› ï¸ **æ‡’äººé…ç½®** - æä¾›äº¤äº’å¼å¼•å¯¼è„šæœ¬ `launcher.py`ï¼Œä¸€é”®å®Œæˆç¯å¢ƒä¸å‚æ•°é…ç½®

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½² (æ¨è)

æœ€ç®€å•ã€æœ€ç¨³å®šçš„è¿è¡Œæ–¹å¼ã€‚

```bash
# 1. ä¸‹è½½é¡¹ç›®
git clone https://github.com/bwwq/Pixiv-XP-Pusher.git
cd Pixiv-XP-Pusher

# 2. å¯åŠ¨æœåŠ¡ (è‡ªåŠ¨æ„å»ºå¹¶è¿è¡Œ)
chmod +x deploy.sh
./deploy.sh start

# 3. æŸ¥çœ‹æ—¥å¿—
./deploy.sh logs
```

- **åˆæ¬¡å¯åŠ¨**ï¼šå®¹å™¨ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡â€œRun Onceâ€ä»»åŠ¡ï¼Œç„¶åè¿›å…¥å®šæ—¶è°ƒåº¦æ¨¡å¼ã€‚
- **ç®¡ç†å‘½ä»¤**ï¼š
  - `./deploy.sh stop` - åœæ­¢æœåŠ¡
  - `./deploy.sh once` - æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ¨é€
  - `./deploy.sh reset-xp` - æ¸…ç©º XP ç¼“å­˜ï¼ˆä¿ç•™æ”¶è—æ•°æ®ï¼‰

### æ–¹å¼äºŒï¼šæœ¬åœ°ç›´æ¥è¿è¡Œ (Windows/Linux)

#### 1. ç¯å¢ƒå‡†å¤‡
ç¡®ä¿å·²å®‰è£… Python 3.10+ã€‚

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 2. äº¤äº’å¼é…ç½® (å°ç™½æ¨è)
è¿è¡Œå¼•å¯¼è„šæœ¬ï¼Œè·Ÿéšæç¤ºå®Œæˆ Token è·å–ã€è´¦å·è®¾ç½®å’Œæ¨é€é…ç½®ã€‚

```bash
# Windows
start.bat

# Linux/macOS
python launcher.py
```

#### 3. æ‰‹åŠ¨è¿è¡Œ

```bash
# è·å– Pixiv Token (éœ€è¦æµè§ˆå™¨äº¤äº’)
python get_token.py

# ç«‹å³æ‰§è¡Œä¸€æ¬¡æ¨é€
python main.py --once

# å¯åŠ¨å®šæ—¶è°ƒåº¦æ¨¡å¼
python main.py
```

---

## âš™ï¸ é…ç½®æ–‡ä»¶ (config.yaml)

å¦‚æœè·³è¿‡å¼•å¯¼è„šæœ¬æ‰‹åŠ¨é…ç½®ï¼Œè¯·å‚è€ƒä»¥ä¸‹ç»“æ„ã€‚

> **æ³¨æ„**ï¼šæ¨èä½¿ç”¨ `launcher.py` è‡ªåŠ¨ç”Ÿæˆé…ç½®ã€‚

```yaml
pixiv:
  user_id: 12345678       # ä½ çš„ Pixiv ç”¨æˆ· IDï¼ˆç”¨äºåˆ†æ XPï¼‰
  refresh_token: "..."    # å¿…å¡«ï¼Œç”¨äºè®¿é—® API

profiler:
  ai:
    enabled: true
    provider: "openai"    # æ”¯æŒ openai æ ¼å¼æ¥å£
    api_key: "sk-..."
    base_url: "https://api.openai.com/v1"
    model: "gpt-4o-mini"
  
  scan_limit: 1000        # æ¯æ¬¡åˆ†ææ”¶è—çš„æ•°é‡
  discovery_rate: 0.1     # æ¢ç´¢æ–° Tag çš„æ¦‚ç‡

fetcher:
  bookmark_threshold:
    search: 1000          # æœç´¢ç»“æœçš„æœ€ä½æ”¶è—æ•°è¦æ±‚
  subscribed_artists: []  # é¢å¤–å…³æ³¨çš„ç”»å¸ˆ ID åˆ—è¡¨

filter:
  daily_limit: 20         # æ¯æ—¥æ¨é€ä¸Šé™
  exclude_ai: true        # è¿‡æ»¤ AI ç”Ÿæˆä½œå“
  r18_mode: false         # æ˜¯å¦å…è®¸ R18 (éœ€ Token æƒé™)

notifier:
  # å¯ç”¨çš„æ¨é€é€šé“åˆ—è¡¨
  types: [telegram] 
  
  telegram:
    bot_token: "123456:ABC..."
    chat_ids: [123456789]
  
  onebot:
    ws_url: "ws://127.0.0.1:3001"
    private_id: 12345678
```

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
pixiv-xp/
â”œâ”€â”€ config.yaml          # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.py              # ç¨‹åºä¸»å…¥å£ (è°ƒåº¦/æ‰§è¡Œ)
â”œâ”€â”€ launcher.py          # äº¤äº’å¼å¼•å¯¼/ç®¡ç†èœå•
â”œâ”€â”€ start.bat            # Windows å¯åŠ¨è„šæœ¬
â”œâ”€â”€ deploy.sh            # Docker ç®¡ç†è„šæœ¬
â”œâ”€â”€ get_token.py         # Pixiv Token è·å–å·¥å…·
â”œâ”€â”€ requirements.txt     # Python ä¾èµ–
â”œâ”€â”€ docker-compose.yml   # Docker ç¼–æ’
â”œâ”€â”€ pixiv_client.py      # Pixiv API å°è£…
â”œâ”€â”€ profiler.py          # XP ç”»åƒåˆ†ææ ¸å¿ƒ
â”œâ”€â”€ fetcher.py           # å†…å®¹æœç´¢ä¸æŠ“å–
â”œâ”€â”€ filter.py            # è¿‡æ»¤ä¸å»é‡é€»è¾‘
â”œâ”€â”€ database.py          # SQLite æ•°æ®å­˜å‚¨
â””â”€â”€ notifier/            # æ¨é€é€‚é…å™¨ (Telegram, OneBot)
```

---

## ğŸ™‹ å¸¸è§é—®é¢˜

<details>
<summary><b>Q: å¦‚ä½•è·å– Pixiv Refresh Token?</b></summary>
è¿è¡Œ <code>python get_token.py</code>ï¼Œè„šæœ¬ä¼šå¯åŠ¨ä¸€ä¸ª Selenium æµè§ˆå™¨çª—å£å¼•å¯¼ç™»å½•ï¼Œç™»å½•æˆåŠŸåä¼šè‡ªåŠ¨æ•è·å¹¶ä¿å­˜ Tokenã€‚
</details>

<details>
<summary><b>Q: éƒ¨ç½²åœ¨æœåŠ¡å™¨ï¼Œæ— æ³•æ‰“å¼€æµè§ˆå™¨è·å– Token æ€ä¹ˆåŠ?</b></summary>
è¯·åœ¨æœ¬åœ°ç”µè„‘è¿è¡Œ <code>python get_token.py</code> è·å– Token åï¼Œå°†å…¶å¤åˆ¶åˆ°æœåŠ¡å™¨çš„ <code>config.yaml</code> ä¸­ã€‚
</details>

<details>
<summary><b>Q: XP ç”»åƒæ˜¯å¦‚ä½•ç”Ÿæˆçš„?</b></summary>
ç³»ç»Ÿä¼šæ‹‰å–ä½ çš„ Pixiv æ”¶è—å¤¹ï¼ˆå…¬å¼€+ç§å¯†ï¼‰ï¼Œç»Ÿè®¡æ‰€æœ‰ä½œå“çš„æ ‡ç­¾é¢‘ç‡ã€‚ç»“åˆ AI (å¦‚æœå¯ç”¨) æ¸…æ´—åŒä¹‰è¯ï¼ˆå¦‚ "ç™½å‘" = "White Hair"ï¼‰ï¼Œè®¡ç®—å‡ºè¿™ä¸€æ ‡ç­¾çš„æƒé‡ã€‚æ¨é€æ—¶ä¼šæ ¹æ®è¿™äº›æƒé‡ç»„åˆæœç´¢å…³é”®è¯ã€‚
</details>

<details>
<summary><b>Q: ä¸ºä»€ä¹ˆ AI æ¨¡å¼æŠ¥é”™ 401/502?</b></summary>
è¯·æ£€æŸ¥ `config.yaml` ä¸­ LLM çš„ `api_key` å’Œ `base_url` æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœ API ä¸ç¨³å®šï¼Œå¯ä»¥åœ¨é…ç½®ä¸­å…³é—­ AI åŠŸèƒ½ (`enabled: false`)ï¼Œç³»ç»Ÿå°†å›é€€åˆ°çº¯ç»Ÿè®¡æ¨¡å¼è¿è¡Œã€‚
</details>

---

## ğŸ“œ è®¸å¯è¯

MIT License
